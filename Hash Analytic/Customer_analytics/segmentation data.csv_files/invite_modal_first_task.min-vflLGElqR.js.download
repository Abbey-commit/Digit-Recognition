define(["require","exports","tslib","react","react-intl","spectrum/modal/index","modules/clean/deprecated_ajax/ajax_jquery","modules/core/browser_detection","modules/core/i18n","modules/clean/ux_analytics_modal_tracking","modules/constants/page_load","modules/clean/react/css","modules/clean/react/growth/first_task/first_task","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_data","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_invite_content","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_list","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_sidebar","modules/clean/react/table","modules/clean/viewer"],(function(e,t,a,i,s,n,o,l,r,m,d,c,u,_,f,b,v,p,g,h,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstTaskInviteModal=t.FirstTaskInviteModalWithoutCss=void 0,i=a.__importDefault(i),o=a.__importStar(o),l=a.__importStar(l);var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={memberActionsData:void 0},t.focusRef=i.default.createRef(),t}return a.__extends(t,e),t.prototype.loadMemberActionsData=function(e){var t=this.props,i=t.evhMaxDays,s=t.memberList,n=t.relaunchModal,l=t.updateMemberList,r={is_current:!0,limit:s.length,offset:0,sort_column:"user_type",sort_direction:h.TableSortDir.ASC};o.WebRequest({url:"/team/admin/members/list_v2",data:r,subject_user:M.Viewer.get_viewer().work_user,success:function(t){var o={},r=new Date((new Date).setDate(i||0)).toLocaleDateString();JSON.parse(t).members.forEach((function(e){var t=e.user_id;o[t]=a.__assign(a.__assign({},b.getMemberInviteActionsProperties(e,r)),{onClose:function(){n(s)},deleteCallback:function(){for(var e=0;e<s.length&&s[e].user_id!==t;e++);s.splice(e,1),n(s)},roleUpdateCallback:function(e){for(var i=0;i<s.length;i++)if(s[i].user_id===t){var n=a.__assign({},s[i]);n.admin_role=e,s[i]=n}l(s)}})}),{}),e(o)}})},t.prototype.componentDidMount=function(){var e=this,t={platform:this.props.loggingExtras.is_client?f.Platform.DESKTOP_SSCV:l.is_supported_mobile_browser()?f.Platform.MOBILE_WEB:f.Platform.WEB};f.SMBFunnelLogger.setCommonTags(t),f.SMBFunnelLogger.log(_.AMPMetrics.ACTIVATION_IMM_VIEW),this.loadMemberActionsData((function(t){e.setState({memberActionsData:t})}))},t.prototype.componentDidUpdate=function(e){var t=this;e.memberList.length!==this.props.memberList.length&&this.loadMemberActionsData((function(e){t.setState({memberActionsData:e})}))},t.prototype.render=function(){var e=this.props,t=e.open,a=e.tieredAdmin,o=e.teamAvailableRoles,l=e.memberList,c=e.showSidebar,_=e.emails,f=e.sentEmails,b=e.handleOnClose,h=e.onCSVImport,C=e.handleOnSubmit,I=e.handleCSVImport,w=e.renderInputForm,S=e.renderPricingInfo,E=e.renderSubmitBtn,k=e.loggingExtras,A=e.showImportCSV,L=e.isInviteLinkEnabled,D=e.isMobileWeb,y=D?"invite-modal-first-task-mobile":"invite-modal-first-task",T=M.Viewer.get_viewer(),O=T.work_user,x=T.team_id,V=T.team_name;if(!O||!x||!V)return null;var W=O.id,R=1===l.length||D?r.intl.formatMessage({id:"5dI3gl",defaultMessage:"Invite team members"}):r.intl.formatMessage({id:"WzCl9b",defaultMessage:"Manage team members"});return i.default.createElement(s.IntlProvider,{defaultLocale:"en-US",locale:r.localeToBcp47LangTag(d.USER_LOCALE)},i.default.createElement(n.Modal,{className:D?"mw-invites-modal-sheet":"",open:t,ariaLabel:r.intl.formatMessage({id:"Ntdwnu",defaultMessage:"Invite Members"}),displayCloseButton:!0,onRequestClose:function(){f.length&&u.showClinkTooltip(u.TooltipType.Members),b()},overlayClickClose:!0,width:c?960:699,overflowY:!0,focusedElementOnOpen:this.focusRef,appElement:document.body,bodyClassName:"invite-modal "+y+" "+(c?y+"--sidebar-visible":"")},i.default.createElement(m.UXAnalyticsModalTracking,{id:"invite-modal"}),i.default.createElement("div",{className:y+"__container"},i.default.createElement("div",{className:y+"__content"},i.default.createElement("div",{className:y+"__title"},R),i.default.createElement(v.InviteModalInviteContent,{baseClass:y,focusRef:this.focusRef,currentUser:O,handleOnSubmit:C,onCSVImport:h,handleCSVImport:I,renderInputForm:w,renderSubmitBtn:E,showImportCSV:A,isInviteLinkEnabled:L,isMobileWeb:D}),S&&S(),i.default.createElement(p.InviteModalMemberList,{baseClass:y,currentUserId:W,teamId:x,teamName:V,tieredAdmin:a,teamAvailableRoles:o,memberList:l,memberActionsData:this.state.memberActionsData,handleOnClose:b,loggingExtras:k,isMobileWeb:D})),c&&i.default.createElement(g.InviteModalSidebar,{baseClass:y,memberList:l,emails:_,sentEmails:f}))))},t})(i.default.Component);t.FirstTaskInviteModalWithoutCss=C,t.FirstTaskInviteModal=c.requireCssWithComponent(C,["/static/css/dig-components/index.web-vflGJghcb.css","/static/css/teams/admin/widgets/invite_modal/invite_modal_first_task-vfll7ligD.css"])}));
//# sourceMappingURL=invite_modal_first_task.min.js-vflPY9Ql6.map